{% extends 'base-analisis.html' %}
{% load staticfiles %}
{% block titulo %}
Analisis
{% endblock %}
{% block css %}
    <link rel="stylesheet" href="{% static 'css/analisis.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-datetimepicker.min.css' %}">
{% endblock %}
{% block contenido %}
<div class="container">
  <div class="row text-center">
      <h1 class="text-center">Analisis de datos</h1>
    <div class="col-sm-4 col-sm-offset-4">
      <p>
        {% if request.user.is_staff %}
            <div id="resp"></div>
            <div class="progress" style="display: none;">
                <div id="theBar" class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                    0%
                </div>
            </div>
            <form>
                <div class="form-group">
                    <input size="16" type="text" placeholder="Inicio" readonly class="form_datetime form-control">
                </div>
                <div class="form-group">
                    <input size="16" type="text" placeholder="Fin" readonly class="form_datetime form-control">
                </div>
                <button type="button" id="time" class="btn btn-lg btn-success">Ejecutar ETL <i class="fa fa-database fa-2x" aria-hidden="true"></i></button>
            </form>
        {% endif %}
      </p>
    </div>
  </div>
</div>
<script src="{% static 'js/bootstrap-datetimepicker.min.js' %}"></script>
<script type="text/javascript">
    $(".form_datetime").datetimepicker({format: 'yyyy-mm-dd hh:ii'});
    $("#time").click(time);
    function time() {
            $(".progress").show();;
            var i = 99;
            var a=0;
            var counterBack = setInterval(function(){
            if(i>0){
                document.getElementById("theBar").style.width = i+1+"%";
                document.getElementById("theBar").innerHTML = i+1+"%";
                if(a==0){
                    $("#resp").append("Carga realizada");
                    a=1;
                }
            } else {
                clearTimeout(counterBack);
            }
            }, 1000);
        };
</script>
{% endblock %}